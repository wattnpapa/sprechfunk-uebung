<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprechfunk Ãœbungsgenerator</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/favicon.png">

    <!-- Titel & Beschreibung -->
    <title>Sprechfunk Ãœbungsgenerator</title>
    <meta name="description"
        content="Erstelle realistische Sprechfunk-Ãœbungen fÃ¼r Ausbildung und Training mit dem Sprechfunk Ãœbungsgenerator.">
    <meta name="keywords"
        content="Sprechfunk, BOS-Funk, FunkÃ¼bung, THW, Feuerwehr, Katastrophenschutz, Kommunikationstraining">
    <meta name="author" content="Johannes Rudolph">

    <!-- Open Graph fÃ¼r Social Media (Facebook, LinkedIn) -->
    <meta property="og:title" content="Sprechfunk Ãœbungsgenerator">
    <meta property="og:description"
        content="Erstelle realistische Sprechfunk-Ãœbungen fÃ¼r Ausbildung und Training mit dem Sprechfunk Ãœbungsgenerator.">
    <!--<meta property="og:image" content="https://yourdomain.com/assets/preview-image.png">-->
    <meta property="og:url" content="https://yourdomain.com">
    <meta property="og:type" content="website">

    <!-- Twitter Card fÃ¼r Twitter Vorschau -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sprechfunk Ãœbungsgenerator">
    <meta name="twitter:description"
        content="Erstelle realistische Sprechfunk-Ãœbungen fÃ¼r Ausbildung und Training mit dem Sprechfunk Ãœbungsgenerator.">
    <!--<meta name="twitter:image" content="https://yourdomain.com/assets/preview-image.png">-->

    <script src="https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js"></script>
    <!-- Bootstrap fÃ¼r Styling -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Richtige FontAwesome Einbindung -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- jsPDF fÃ¼r PDF-Erstellung -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- AutoTable fÃ¼r saubere Tabellen -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <!-- html2canvas fÃ¼r HTML-to-Image-Rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Chart.js CDN fÃ¼r das Balkendiagramm -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>


    <!-- Bootstrap JS (erforderlich fÃ¼r das Modal) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7FN1RQ6MK4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-7FN1RQ6MK4');
    </script>


    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center">
            <h2 class="text-primary mb-3">
                <i class="fas fa-broadcast-tower"></i> Sprechfunk Ãœbungsgenerator
            </h2>

            <!-- Buttons fÃ¼r groÃŸe Bildschirme -->
            <div class="d-none d-md-block">
                <a href="https://github.com/wattnpapa/sprechfunk-uebung" class="btn btn-dark">
                    <i class="fab fa-github"></i> GitHub
                </a>
                <button class="btn btn-info" data-bs-toggle="modal" data-bs-target="#howtoModal">
                    <i class="fas fa-question-circle"></i> Anleitung
                </button>
                <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#authorModal">
                    <i class="fas fa-user"></i> Ãœber den Autor
                </button>
            </div>

            <!-- Dropdown fÃ¼r kleine Bildschirme -->
            <div class="d-md-none dropdown">
                <button class="btn btn-primary dropdown-toggle" type="button" id="mobileMenu" data-bs-toggle="dropdown"
                    aria-expanded="false">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="mobileMenu">
                    <li>
                        <a class="dropdown-item" href="https://github.com/wattnpapa/sprechfunk-uebung" target="_blank">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                    </li>
                    <li>
                        <button class="dropdown-item" data-bs-toggle="modal" data-bs-target="#howtoModal">
                            <i class="fas fa-question-circle"></i> Anleitung
                        </button>
                    </li>
                    <li>
                        <button class="dropdown-item" data-bs-toggle="modal" data-bs-target="#authorModal">
                            <i class="fas fa-user"></i> Ãœber den Autor
                        </button>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="howtoModal" tabindex="-1" aria-labelledby="howtoModalLabel" aria-hidden="true">
            <div class="modal-dialog" style="max-width: 90%;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="howtoModalLabel">Anleitung</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="howtoContent">LÃ¤dt...</div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">SchlieÃŸen</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal fÃ¼r die Autor-Info -->
        <div class="modal fade" id="authorModal" tabindex="-1" aria-labelledby="authorModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg"> <!-- GrÃ¶ÃŸeres Modal -->
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="authorModalLabel">Ãœber den Autor</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="SchlieÃŸen"></button>
                    </div>
                    <div class="modal-body text-center">

                        <!-- Gravatar Bild -->
                        <img src="https://www.gravatar.com/avatar/b4d8c8a87a392586b9caee287180163b?s=200"
                            alt="Johannes Rudolph" class="rounded-circle mb-3" width="150" height="150">

                        <h4>ðŸ‘‹ Moin! Ich bin Johannes.</h4>
                        <p>
                            Technik-Enthusiast, ProblemlÃ¶ser und immer auf der Suche nach smarten LÃ¶sungen â€“ sei es in
                            der IT, im Ehrenamt oder im Alltag.
                        </p>
                        <h5>ðŸ’¼ Beruflich</h5>
                        <p>
                            Als <b>Head of Business Development</b> bei DIA Connecting Software bin ich die
                            Schnittstelle zwischen Entwicklern, Kunden und Management.
                            Mein Fokus liegt auf der <b>Vernetzung von Systemen</b>, um Unternehmen effizienter zu
                            machen. Ich liebe es, komplexe technische Herausforderungen
                            in einfache, greifbare LÃ¶sungen zu verwandeln.
                        </p>
                        <h5>ðŸš€ Privat</h5>
                        <p>
                            In meiner Freizeit bin ich ein echter Macher â€“ sei es bei <b>DIY-Projekten, smarter Technik
                                oder Heimautomation</b>. Ich probiere gerne neue Dinge aus
                            und optimiere Prozesse, egal ob digital oder analog. AuÃŸerdem verbringe ich viel Zeit mit
                            meiner Familie und liebe es, Technik in den Alltag zu integrieren.
                        </p>
                        <h5>ðŸ“Ÿ Ehrenamtliches Engagement</h5>
                        <p>
                            Seit <b>2007 bin ich beim Technischen Hilfswerk (THW)</b> aktiv. Aktuell bin ich
                            <b>GruppenfÃ¼hrer der Fachgruppe Kommunikation</b> und
                            <b>Bereichsausbilder fÃ¼r Sprechfunk</b>. Im Einsatz Ã¼bernehme ich die Rolle des
                            <b>Sachgebietsleiters in FÃ¼hrungsstellen und Einsatzleitungen</b>.
                            Mein Schwerpunkt liegt darauf, sichere Kommunikationswege fÃ¼r EinsatzkrÃ¤fte zu gewÃ¤hrleisten
                            und digitale Technologien im Krisenmanagement zu nutzen.
                        </p>
                        <h5>ðŸ“Œ Mein Motto:</h5>
                        <p class="fst-italic">"Technik verstehen, vernetzen und sinnvoll einsetzen â€“ beruflich, privat
                            und im Ehrenamt."</p>
                        <h5>ðŸ“¡ Interessen:</h5>
                        <ul class="list-unstyled">
                            <li>âœ” IT & Softwareentwicklung</li>
                            <li>âœ” Funktechnik & Kommunikation</li>
                            <li>âœ” Automatisierung & smarte Technologien</li>
                            <li>âœ” Katastrophenschutz & FÃ¼hrungsstrukturen</li>
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">SchlieÃŸen</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hauptbereich mit Kopfdaten, Einstellungen und Teilnehmerverwaltung nebeneinander -->
        <div class="row">

            <!-- Card fÃ¼r Kopfdaten (links) -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-info-circle"></i> Kopfdaten</h4>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Datum der Ãœbung:</label>
                            <input type="date" class="form-control" id="datum" value="2025-03-29">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Name der Ãœbung:</label>
                            <input type="text" class="form-control" id="nameDerUebung">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Rufgruppe der Ãœbung:</label>
                            <input type="text" class="form-control" id="rufgruppe">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Funkrufname der Ãœbungsleitung:</label>
                            <input type="text" class="form-control" id="leitung">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card fÃ¼r Einstellungen (Mitte) -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-comment"></i> Einstellungen</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <!-- Anzahl FunksprÃ¼che pro Teilnehmer -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">FunksprÃ¼che pro Teilnehmer:</label>
                                <input type="number" class="form-control" id="spruecheProTeilnehmer" min="1" value="50">
                            </div>

                            <!-- Nachrichten an alle -->
                            <div class="col-md-6 mb-6">
                                <label class="form-label">% an Alle:</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="prozentAnAlle" min="0" max="100"
                                        value="10" >
                                    <span class="input-group-text">%</span>
                                </div>
                                <small class="text-muted">Ergibt <span id="calcAnAlle">5</span> Nachrichten</small>
                                <input type="hidden" id="spruecheAnAlle" value="5">
                            </div>  
                            <!-- Nachrichten an mehrere -->
                            <div class="col-md-6 mb-6">
                                <label class="form-label">% an Mehrere:</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="prozentAnMehrere" min="0" max="100"
                                        value="5">
                                    <span class="input-group-text">%</span>
                                </div>
                                <small class="text-muted">Ergibt <span id="calcAnMehrere">2</span> Nachrichten</small>
                                <input type="hidden" id="spruecheAnMehrere" value="2">
                            </div>
                            <!-- Buchstabieranteil -->
                            <div class="col-md-6 mb-6">
                                <label class="form-label">% Buchstabier-Aufgaben:</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="prozentAnBuchstabieren" min="0" max="100"
                                        value="0">
                                    <span class="input-group-text">%</span>
                                </div>
                                <small class="text-muted">Ergibt <span id="calcAnBuchstabieren">0</span> Nachrichten</small>
                                <input type="hidden" id="spruecheAnBuchstabieren" value="0">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="funkspruchVorlage" class="form-label">Funkspruch-Vorlage auswÃ¤hlen:</label>
                            <select class="form-control" id="funkspruchVorlage" onchange="app.toggleFileUpload()">
                            </select>
                        </div>

                        <!-- Container fÃ¼r den Datei-Upload -->
                        <div class="mb-3" id="fileUploadContainer" style="display: none;">
                            <label class="form-label">FunksprÃ¼che hochladen:</label>
                            <input type="file" class="form-control" id="funksprueche" accept=".txt">
                        </div>

                        <!-- LÃ¶sungswÃ¶rter -->
                        <div class="mb-3">
                            <label class="form-label">LÃ¶sungswÃ¶rter:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" id="keineLoesungswoerter"
                                    name="loesungswortOption" checked onclick="app.renderTeilnehmer()">
                                <label class="form-check-label" for="keineLoesungswoerter">Keine LÃ¶sungswÃ¶rter</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" id="zentralLoesungswort"
                                    name="loesungswortOption" onclick="app.renderTeilnehmer()">
                                <label class="form-check-label" for="zentralLoesungswort">Zentrales LÃ¶sungswort</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" id="individuelleLoesungswoerter"
                                    name="loesungswortOption" onclick="app.renderTeilnehmer()">
                                <label class="form-check-label" for="individuelleLoesungswoerter">Individuelle
                                    LÃ¶sungswÃ¶rter</label>
                            </div>
                            <div id="zentralLoesungswortContainer" style="display: none;">
                                <input type="text" id="zentralLoesungswortInput" class="form-control mt-2"
                                    placeholder="Zentrales LÃ¶sungswort">
                            </div>
                        </div>

                        <button id="shuffleButton" class="btn btn-primary" onclick="app.shuffleLoesungswoerter()"
                            style="display: none;">
                            ðŸ”€ LÃ¶sungswÃ¶rter ZufÃ¤llig neu zuweisen
                        </button>
                    </div>
                </div>
            </div>

            <!-- Card fÃ¼r Teilnehmerverwaltung (rechts) -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h4 class="text-primary"><i class="fas fa-users"></i> Teilnehmerverwaltung</h4>
                    </div>
                    <div class="card-body">
                        <!-- Teilnehmerliste -->
                        <div class="row" id="teilnehmer-container">
                            <!-- Hier wird per JS die Tabelle eingefÃ¼gt -->
                        </div>
                        <!-- Teilnehmer hinzufÃ¼gen Button -->
                        <button class="btn btn-success mt-3" onclick="app.addTeilnehmer()">Teilnehmer
                            hinzufÃ¼gen</button>
                    </div>
                </div>
            </div>
        </div>

        <button class="btn btn-success w-100 mt-4" onclick="app.startUebung()">
            <i class="fas fa-cogs"></i> Ãœbung generieren
        </button>

        <div id="output-container" style="display: none; margin-top: 20px;">
            <!-- GeschÃ¤tzte Dauer der Ãœbung -->

            <!-- Vorschau der generierten Seiten -->
            <div class="card mb-3">
                <div class="card-header">
                    <h5 class="d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-file-alt"></i> Vorschau der generierten Seiten</span>
                        <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="collapse"
                            data-bs-target="#collapseVorschau">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </h5>
                </div>
                <div id="collapseVorschau" class="collapse show">
                    <div class="card-body text-center">
                        <button class="btn btn-secondary" onclick="app.changePage(-1)">â¬… ZurÃ¼ck</button>
                        <span id="current-page">Seite 1 / 1</span>
                        <button class="btn btn-secondary" onclick="app.changePage(1)">Weiter âž¡</button>
                        <button class="btn btn-danger" onclick="app.generatePDFs()">
                            <i class="fas fa-file-pdf"></i> Teilnehmer PDFs generieren
                        </button>
                        <button class="btn btn-warning" onclick="app.generateNachrichtenvordruckPDFs()">
                            <i class="fas fa-file-pdf"></i> Nachrichtenvordruck PDFs generieren
                        </button>
                        <button class="btn btn-warning" onclick="app.generateMeldevordruckPDFs()">
                            <i class="fas fa-file-pdf"></i> Meldevordruck PDFs generieren
                        </button>
                        <button class="btn btn-info" onclick="app.generateInstructorPDF()">
                            <i class="fas fa-user-tie"></i> Ãœbungsleitung PDF erzeugen
                        </button>
                        <button class="btn btn-outline-dark" onclick="app.exportUebungAsJSON()" hidden>
                            <i class="fas fa-code"></i> Export als JSON
                          </button>
                        <button id="downloadZip" class="btn btn-primary" onclick="pdfGenerator.generateAllPDFsAsZip(window.app.funkUebung)">ðŸ“¦ Alle PDFs als ZIP herunterladen</button>
                        <iframe id="resultFrame" style="width: 100%; height: 400px; border: 1px solid #ccc; margin-top: 20px;"></iframe>
                    </div>
                </div>
            </div>

            <!-- JSON Modal -->
            <div class="modal fade" id="jsonModal" tabindex="-1" aria-labelledby="jsonModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="jsonModalLabel">Ãœbungsdaten als JSON</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="SchlieÃŸen"></button>
                    </div>
                    <div class="modal-body">
                    <pre id="jsonOutput" style="white-space: pre-wrap; word-wrap: break-word; background-color: #f8f9fa; padding: 1rem; border-radius: .3rem;"></pre>
                    </div>
                    <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">SchlieÃŸen</button>
                    <button class="btn btn-primary" onclick="app.copyJSONToClipboard()">ðŸ“‹ In Zwischenablage kopieren</button>
                    </div>
                </div>
                </div>
            </div>

            <!-- Nachrichtenverteilung -->
            <div class="card mb-3">
                <div class="card-header">
                    <h5 class="d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-chart-bar"></i> Nachrichtenverteilung</span>
                        <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="collapse"
                            data-bs-target="#collapseDiagramm">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </h5>
                </div>
                <div id="collapseDiagramm" class="collapse show">
                    <div class="card-body">
                        <canvas id="distributionChart"></canvas>
                    </div>
                </div>
            </div>


            <!-- Dauer der Ãœbung-->
            <div class="card mb-3">
                <div class="card-header">
                    <h5 class="d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-clock"></i> GeschÃ¤tzte Dauer der Ãœbung</span>
                        <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="collapse"
                            data-bs-target="#collapseDauer">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </h5>
                </div>
                <div id="collapseDauer" class="collapse show">
                    <div class="card-body">
                        <table class="table table-bordered">
                            <thead class="table-dark">
                                <tr>
                                    <th></th>
                                    <th>Dauer in Minuten</th>
                                    <th>Dauer in Stunden und Minuten</th>
                                    <th>Durchschnittliche Zeit pro Funkspruch (Sek.)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Optimal</td>
                                    <td id="dauerOptimalMinuten">- Min</td>
                                    <td id="dauerOptimalStundenMinuten">- Std - Min</td>
                                    <td id="durchschnittOptimal">- Sek</td>
                                </tr>
                                <tr>
                                    <td>Langsam</td>
                                    <td id="dauerLangsamMinuten">- Min</td>
                                    <td id="dauerLangsamStundenMinuten">- Std - Min</td>
                                    <td id="durchschnittLangsam">- Sek</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>



        <footer class="main-footer">
            <div class="float-right d-none d-sm-block">
                <b>Version</b> <span id="version">1.0.0</span> | <b>Ãœbung ID:</b> <span id="uebungsId">-</span>
            </div>
            <strong>Â© Johannes Rudolph | <a href="https://wattnpapa.github.io/sprechfunk-uebung/"
                    target="_blank">Generator</a> | <a href="https://github.com/wattnpapa/sprechfunk-uebung"
                    target="_blank">GitHub-Repository</a></strong>
        </footer>

        <script type="module" src="src/app.js"></script>
        <script src="help.js"></script>
        <script src="track.js"></script>
</body>

</html>